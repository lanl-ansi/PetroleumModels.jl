# MatlabPetroleum Format (.m)

Here we detail the parameters that can be inputted using the matpetroleum format. They can be inputted in the order they appear here, or selectively, in the case where some data is not required, by using the following header format.

```matlab
%% junction data
% junction_i type Hmin Hmax z status
```

See case files in `test/data/` for examples of file syntax.

## Junctions (mpc.junction)

These components model “point” locations in the system, i.e. locations of withdrawal or injection, or simply connection points between pipes. Each junction may have multiple pipes attached.

| Variable      | Type    | Name             | Standard Units (SI) | United States Customary Units | Required           | Description                                                                                                                                      |
| ------------- | ------- | ---------------- | ------------------- | ----------------------------- | ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| junction_i            | Int     | Junction id      |                     |                               | Y | Unique id for junctions                                                                                                                          |
| type | Int     | Junction Type    |                     |                               | Y | Classification of the junction: 0 = standard node, 1 = slack node                                                                                |
| Hmin         | Float64 | Head Minimum | m              | ft                           | Y |  Minimum operating head used in line pack calculations, which is higher than the minimum allowable                                                                                                                          |
| Hmax         | Float64 | Head Maximum | m              | ft                           | Y | Maximum operating head used in line pack calculations, which is lower than the maximum allowable operating pressure (MAOP, psig) |                                                                           |
| z           | Float64 | Elevation         | m     | ft               |                    | Elevation of the junction                                                                                                                         |
| status        | Int     | Junction Status  |                     |                               | Y | Determines if the component is active in the model                                                                                               |

## Pipes (mpc.pipe)
  status
These components model pipelines which connect two junctions.

| Variable                          | Type    | Name              | Standard Units (SI) | United States Customary Units | Required           | Description                                                                                                                             |
| --------------------------------- | ------- | ----------------- | ------------------- | ----------------------------- | ------------------ | --------------------------------------------------------------------------------------------------------------------------------------- |
| pipeline_i                                | Int     | Pipe id           |                     |                               | Y | Unique id for pipes                                                                                                                     |
| fr_junction                       | Int     | From Junction id  |                     |                               | Y | Unique id of the junction on the from side                                                                                              |
| to_junction                       | Int     | To Junction id    |                     |                               | Y | Unique id of the junction on the to side                                                                                                |
| diameter                          | Float64 | Diameter          | Meters              | Inches                        | Y | Pipe diameter                                                                                                                           |
| length                            | Float64 | Length            | Meters              | Miles                         | Y | Pipe Length                                                                                                                             |
| Qmin                             | Float64 | Flow Rate Minimum  | m3/h              | ft3/h                           | Y | Minimum allowable operating flow rate, usually depends on pipe diameter |
| Qmax                             | Float64 | Flow Rate Maximum  | m3/h              | ft3/h                           | Y | Maximum allowable operating flow rate, usually depends on pipe diameter                                                          |
| status                            | Int     | Pipe status       |                     |                               | Y | Determines if the component is active in the model                                                                                      |

## Pumps (mpc.pump)
  delta_Hmin min_pump_efficiency max_pump_efficiency w_nom min_w max_w electricity_price status
These components model infrastructure used to boost pressure between two nodes.

| Variable                       | Type    | Name                             | Standard Units (SI) | United States Customary Units | Required           | Description                                                                                                                                                                                                                                             |
| ------------------------------ | ------- | -------------------------------- | ------------------- | ----------------------------- | ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| pump_i                             | Int     | pump id                    |                     |                               | Y | Unique id for pump                                                                                                                                                                                                                                |
| fr_junction                    | Int     | From Junction id                 |                     |                               | Y | Unique id of the junction on the from side                                                                                                                                                                                                              |
| to_junction                    | Int     | To Junction id                   |                     |                               | Y | Unique id of the junction on the to side                                                                                                                                                                                                                |
| station_i                    | Int | Pump station id        |                     |                               | Y | Unique id of the station including up to 3 pumps                                                                                                                                                                                                                               |
| a                    | Float64 | Pump coefficient        |    Meters                 |        Feet                       | Y | Pump coefficient required to define pump head                                                                                                                                                                                                                               |
| b                    | Float64 | Pump coefficient        |    h2/m5                 |        h2/ft5                       | Y | Pump coefficient required to define pump head                                                                                                                                                                                                                               |
| q_nom                      | Float64 | Nominal flow rate                   | m3/h                   | ft3/h                            | Y | Pump nominal flow rate                                                                                                                                                                                      |
| delta_Hmax                       | Float64 | Maximum head difference                | m                |    ft                           | Y | Maximum head flow                                                                                                                                                                                                                                       |
| flow_max                       | Float64 | Maximum mass flow                | kg/s                |                               | Y | Maximum mass flow                                                                                                                                                                                                                                       |
| inlet\_p\_min                    | Float64 | Minimum inlet pressure           | Pascal              | PSI                           | Y | Minimum pressure at pump inlet                                                                                                                                                                                                                    |
| inlet\_p\_max                    | Float64 | Maximum inlet pressure           | Pascal              | PSI                           | Y | Maximum pressure at pump inlet                                                                                                                                                                                                                    |
| outlet\_p\_min                   | Float64 | Minimum outlet pressure          | Pascal              | PSI                           | Y | Minimum pressure at pump outlet                                                                                                                                                                                                                   |
| outlet\_p\_max                   | Float64 | Maximum outlet pressure          | Pascal              | PSI                           | Y | Maximum pressure at pump outlet                                                                                                                                                                                                                   |
| status                         | Int     | pump status                |                     |                               | Y | Determines if the component is active in the model                                                                                                                                                                                                      |
| operating_cost                 | Float64 | Operating cost                   | $/W                 | $/kW                          |                    | Cost to operate pump                                                                                                                                                                                                                              |
| directionality                 | Int     | Directionality                   |                     |                               |                    | An integer value that denotes the directionality of compression and flow: 0 = bi-directional pump, 1 = unidirectional pump with no reversal for flow allowed, 2 = unidirectional pump which allows for uncompressed reversal of flows |
| pump_station_name        | String  | pump Station Name          |                     |                               |                    | Name of pump stations                                                                                                                                                                                                                             |
| pipeline_name                  | String  | Pipeline name                    |                     |                               |                    | Name of Pipeline                                                                                                                                                                                                                                        |
| total\_installed\_power          | Float64 | Total installed power            | W                   | W                             |                    | Total installed horsepower – same as maximum power                                                                                                                                                                                                      |
| num\_pump\_units           | Int     | Number of pump units       |                     |                               |                    | Number of pump units – needed to account for number of gas-fired pumps versus those driven by electric power                                                                                                                                |
| pump_type                | String  | pump Type                  |                     |                               |                    | pump type (reciprocal versus turbine) – used to determine pump efficiency                                                                                                                                                                   |
| design\_suction\_pressure        | Float64 | Design Suction Pressure          | Pascal              | PSI                           |                    | Used to estimate pump max pressure delta                                                                                                                                                                                                          |
| design\_discharge\_pressure      | Float64 | Design discharge pressure        | Pascal              | PSI                           |                    | Used to determine maximum extent of line pack for downstream pipeline segments                                                                                                                                                                          |
| max\_compressed\_volume          | Float64 | Maximum compressed volume        |                     |                               |                    | Maximum volume compressed at design conditions                                                                                                                                                                                                          |
| design\_fuel\_required           | Float64 | Design fuel required             |                     | MMSCFD                        |                    | Fuel required at design conditions                                                                                                                                                                                                                      |
| design\_electric\_power\_required | Float64 | Design electric power required   |                     | kWh/day                       |                    | Electric power required at design conditions – determines which pump stations could be affected by an electric outage                                                                                                                             |
| num\_units\_for\_peak\_service     | Int     | Number of units for peak service |                     |                               |                    | Number of units in service during peak conditions                                                                                                                                                                                                       |
| peak_year                      | Int     | Peak year                        |                     |                               |                    | Year of peak conditions                                                                                                                                                                                                                                                                                                                                                                                  |

## Consumers (mpc.consumer)

These components model consumers of product.

| Variable             | Type    | Name                  | Standard Units (SI) | United States Customary Units | Required           | Description                                                                                                                                                                                        |
| -------------------- | ------- | --------------------- | ------------------- | ----------------------------- | ------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| id                   | Int     | consumer id            |                     |                               | Y | Unique id for consumer                                                                                                                                                                              |
| junction_id          | Int     | Junction id           |                     |                               | Y | Unique id of Junction to which component is connected                                                                                                                                              |
| injection_min        | Float64 | Minimum Injection     | kg/s                | MMSCFD                        | Y | Minimum amount of gas that can be injected                                                                                                                                                         |
| injection_max        | Float64 | Maximum Injection     | kg/s                | MMSCFD                        | Y | Maximum amount of gas that can be injected                                                                                                                                                         |
| injection_nominal    | Float64 | Nominal Injection     | kg/s                | MMSCFD                        | Y | Nominal gas injection                                                                                                                                                                              |
| is_dispatchable      | Int     | Dispatchable          |                     |                               | Y | If the component is marked as dispatchable, it means that it can vary its injection between its minimum and maximum. If not, then the component is injecting exactly at the nominal injection rate |
| status               | Int     | consumer status        |                     |                               | Y | Determines if the component is active in the model                                                                                                                                                 |
| offer_price          | Float64 | Offer Price           | $/W                 | $/vol                         |                    | Offer price                                                                                                                                                                                        |
| name                 | String  | consumer Name          |                     |                               |                    | Name of consumer point                                                                                                                                                                              |
| company_name         | String  | Company Name          |                     |                               |                    | Name of company that owns consumer point                                                                                                                                                            |
| daily\_scheduled\_flow | Float64 | Daily Scheduled Flow  |                     | MMSCFD                        |                    | Provided by real-time data collection (EDI), model constraint                                                                                                                                      |
| design_capacity      | Float64 | Design Capacity       |                     | MMSCFD                        |                    | Provided by real-time data collection (EDI), model constraint                                                                                                                                      |
| operating_capacity   | Float64 | Operating Capacity    |                     | MMSCFD                        |                    | Provided by real-time data collection (EDI), model constraint                                                                                                                                      |
| is_firm              | Int     | Interruptable vs Firm |                     |                               |                    | Identifies the order by which the consumer flow could be curtailed (interruptible first, then firm)                                                                                                 |
| edi_id               | Int     | EDI ID                |                     |                               |                    | Unique ID to allow easy input of near-real-time EDI data                                                                                                                                           |

## Producers (mpc.producer)

These components model producers (providers) of liquid product.

| Variable             | Type    | Name                  | Standard Units (SI) | United States Customary Units | Required           | Description                                                                                                                                                                                        |
| -------------------- | ------- | --------------------- | ------------------- | ----------------------------- | ------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| id                   | Int     | producer id           |                     |                               | Y | Unique id for producer                                                                                                                                                                             |
| junction_id          | Int     | Junction id           |                     |                               | Y | Unique id of Junction to which component is connected                                                                                                                                              |
| withdrawal_min       | Float64 | Minimum withdrawal    | kg/s                | MMSCFD                        | Y | Minimum amount of gas that can be withdrawn                                                                                                                                                        |
| withdrawal_max       | Float64 | Maximum withdrawal    | kg/s                | MMSCFD                        | Y | Maximum amount of gas that can be withdrawn                                                                                                                                                        |
| withdrawal_nominal   | Float64 | Nominal withdrawal    | kg/s                | MMSCFD                        | Y | Nominal gas withdrawal                                                                                                                                                                             |
| is_dispatchable      | Int     | Dispatchable          |                     |                               | Y | If the component is marked as dispatchable, it means that it can vary its injection between its minimum and maximum. If not, then the component is injecting exactly at the nominal injection rate |
| status               | Int     | producer status       |                     |                               | Y | Determines if the component is active in the model                                                                                                                                                 |
| bid_price            | Float64 | Bid Price             | $/W                 | $/vol                         |                    | Bid price                                                                                                                                                                                          |
| name                 | String  | producer Name         |                     |                               |                    | Name of producer point                                                                                                                                                                             |
| company_name         | String  | Company Name          |                     |                               |                    | Name of company that owns producer point                                                                                                                                                           |
| daily\_scheduled\_flow | Float64 | Daily Scheduled Flow  |                     | MMSCFD                        |                    | Provided by real-time data collection (EDI), model constraint                                                                                                                                      |
| design_capacity      | Float64 | Design Capacity       |                     | MMSCFD                        |                    | Provided by real-time data collection (EDI), model constraint                                                                                                                                      |
| operating_capacity   | Float64 | Operating Capacity    |                     | MMSCFD                        |                    | Provided by real-time data collection (EDI), model constraint                                                                                                                                      |
| is_firm              | Int     | Interruptable vs Firm |                     |                               |                    | Identifies the order by which the d flow could be curtailed (interruptible first, then firm)                                                                                                       |
| edi_id               | Int     | EDI ID                |                     |                               |                    | Unique ID to allow easy input of near-real-time EDI data                                                                                                                                           |

## Storage (mpc.storage)

These components are used to model locations which can store and release natural gas.

| Variable                 | Type    | Name                     | Standard Units (SI) | United States Customary Units | Required           | Description                                                     |
| ------------------------ | ------- | ------------------------ | ------------------- | ----------------------------- | ------------------ | --------------------------------------------------------------- |
| id                       | Int     | Storage id               |                     |                               | Y | Unique id for storage                                           |
| junction_id              | Int     | Junction id              |                     |                               | Y | Unique id of Junction to which component is connected           |
| pressure_nominal         | Float64 | Nominal pressure         | Pascal              | PSI                           | Y | pressure at the storage                                         |
| flow\_injection\_rate\_min  | Float64 | Minimum injection rate   | kg/s                | MMSCFD                        | Y | Minimum flow injection rate                                     |
| flow\_injection\_rate\_max  | Float64 | Maximum injection rate   | kg/s                | MMSCFD                        | Y | Maximum flow injection rate                                     |
| flow\_withdrawal\_rate\_min | Float64 | Minimum withdrawal rate  | kg/s                | MMSCFD                        | Y | Minimum flow withdrawal rate                                    |
| flow\_withdrawal\_rate\_max | Float64 | Maximum withdrawal rate  | kg/s                | MMSCFD                        | Y | Maximum flow withdrawal rate                                    |
| capacity                 | Float64 | Capacity                 | kg                  | MMSCF                         | Y | Capacity of the storage                                         |
| status                   | Int     | Storage status           |                     |                               | Y | Determines if the component is active in the model              |
| name                     | String  | Storage Name             |                     |                               |                    | Name of the Storage point                                       |
| owner_name               | String  | Owner Name               |                     |                               |                    | Name of the Storage point owner                                 |
| storage_type             | String  | Storage type             |                     |                               |                    | Type of storage (aquifer, salt cavern, or depleted oil and gas) |
| daily\_withdrawal\_max     | Float64 | Daily withdrawal rate    | kg/s                | MMSCFD                        |                    | Maximum daily withdrawal                                        |
| seasonal\_withdrawal\_max  | Float64 | Seasonal withdrawal rate | kg/s                | MMSCFD                        |                    | Maximum Seasonal withdrawal                                     |
| base\_gas\_capacity        | Float64 | Base gas capacity        | kg                  | MMSCF                         |                    | Base gas capacity                                               |
| working\_gas\_capacity     | Float64 | Working gas capacity     | kg                  | MMSCF                         |                    | Working gas capacity                                            |
| total\_field\_capacity     | Float64 | Total field capacity     | kg                  | MMSCF                         |                    | Total field gas capacity                                        |
| edi_id                   | Int     | EDI ID                   |                     |                               |                    | Unique ID to allow easy input of near-real-time EDI data        |

## Network Parameters (mpc._parameter_)

| Variable                     | Type    | Name                   | Standard Units (SI) | United States Customary Units | Required | Description                                                        |
| ---------------------------- | ------- | ---------------------- | ------------------- | ----------------------------- | -------- | ------------------------------------------------------------------ |
| gas\_specific\_gravity         | Float64 | Specific Gravity       |                     |                               |          | Gas gravity                                                        |
| specific\_heat\_capacity\_ratio | Float64 | Specific heat capacity |                     |                               |          | specific heat capacity ratio                                       |
| temperature                  | Float64 | Temperature            | K                   |                               |          | temperature of the network                                         |
| sound_speed                  | Float64 | Speed of Sound         | m/s                 |                               |          | speed of sound in gas                                              |
| R                            | Float64 | Universal Gas Constant | J/mol/K             |                               |          | Universal gas constant                                            |
| gas\_molar\_mass               | Float64 | Molar Mass             | kg/mol              |                               |          | Molar Mass                                                         |
| compressibility_factor       | Float64 | Compressibility factor |                     |                               |          | Compressibility factor (unitless)                                  |
| base_pressure                | Float64 | Base Pressure          | Pascal              | PSI                           |          | Base pressure in Pa or psi                                         |
| base_length                  | Float64 | Base Length            | Meters              | Miles                         |          | Base length in m or miles                                          |
| base_time                    | Float64 | Base Time              | Hours               | Hours                         |          | Base time in hr                                                    |
| units                        | String  | Units                  |                     |                               |          | 'si' for standard units or 'usc' for United States customary units |
| is\_per\_unit                  | Int     | Per-unit               |                     |                               |          | If data is already in per-unit (non-dimensionalized                |
| name                         | String  | Case Name              |                     |                               |          | Name of Network Case                                               |
| year                         | Int     | Year                   |                     |                               |          | Year from which data originated                                    |

## Matgas extensions

The matgas format supports extensions which allow users to define arbitrary components and data which are used in customized problems and formulations.  For example, the syntax

```julia
  %column_names% data_field_name1, data_field_name2, ...
  mpc.component_data = [
  data1, data2
  data1, data2
  ...
  ]
```

is used to add data to standard gas components.  In this example, the data dictionary for `component` will be augmented with fields called `data_field_name1`, `data_field_name2`, etc. The names trailing the keyword `%column_name%` are used as the keys in the data dictionary for each `component`. The key word `mpc.component_data` is used to indicate the component the new data should be associated with.  For example, `mpc.pipe_data` adds the data to pipes. The data should be listed in the same order as used by the tables that specify the required data for the component.  The syntax

```julia
  %column_names% data_field_name1, data_field_name2, ...
  mpc.component = [
  data1, data2
  data1, data2
  ...
  ]
```

is then used to specify completely new components which are not specified in the default format.  This example would create an entry from components called `component` in the data dictionary.
